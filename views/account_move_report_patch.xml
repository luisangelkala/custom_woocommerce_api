<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <template id="report_invoice_document_inherit_warranty" inherit_id="account.report_invoice_document">

    <xpath expr="//t[@t-set='forced_vat']" position="after">
      <style>
        div[name='operation_type'] { display: none !important; }
      </style>
    </xpath>

    <xpath expr="//t[@t-set='o']" position="replace">
        <t t-set="o" t-value="o.with_context(lang='fr_FR')"/>
    </xpath>

    <xpath expr="//th[@name='th_description']" position="replace">
        <th name="th_description" class="text-start">Produit</th>
    </xpath>
    <xpath expr="//th[@name='th_quantity']" position="replace">
        <th name="th_quantity" class="text-end">Quantit√©</th>
    </xpath>
    <xpath expr="//th[@name='th_priceunit']" position="replace">
        <th name="th_priceunit" class="text-end">Prix</th>
    </xpath>
    <xpath expr="//th[@name='th_subtotal']" position="replace">
        <th name="th_subtotal" class="text-end">Montant</th>
    </xpath>

    <xpath expr="//th[@name='th_taxes']" position="replace"/>
    <xpath expr="//th[@name='th_priceunit']" position="after">
        <th class="text-end">Disc.%</th>
    </xpath>

    <xpath expr="//tbody//tr" position="replace">
        <tr t-foreach="o.invoice_line_ids" t-as="line">
             <t t-if="not line.display_type">
                <td name="account_invoice_line_name"><span t-field="line.product_id.name"/></td>
                
                <td class="text-end">
                    <span t-esc="'%.0f' % line.quantity"/>
                </td>

                <td class="text-end">
                    <span t-esc="'%.0f' % line.sudo().price_unit"/>
                    <span t-esc="o.currency_id.symbol"/>
                </td>

                <td class="text-end">
                    <span t-esc="'%.0f' % line.discount"/> %
                </td>

                <td class="text-end">
                    <span t-esc="'%.0f' % line.price_total"/>
                    <span t-esc="o.currency_id.symbol"/>
                </td>
            </t>
            <t t-if="line.display_type == 'line_section'">
                <td colspan="99">
                    <span t-field="line.name" t-options="{'widget': 'text'}"/>
                </td>
            </t>
            <t t-if="line.display_type == 'line_note'">
                <td colspan="99">
                    <span t-field="line.name" t-options="{'widget': 'text'}"/>
                </td>
            </t>
        </tr>
        </xpath>

    <xpath expr="//div[@id='total']//div//table" position="replace">
        <table class="table table-sm table-borderless">
            <tr>
                <td><strong>Total</strong></td>
                <td class="text-end">
                    <span t-esc="'%.0f' % o.amount_untaxed"/>
                    <span t-esc="o.currency_id.symbol"/>
                </td>
            </tr>
            <tr>
                <td>TVA (20%) :</td>
                <td class="text-end">
                    <span t-esc="'%.0f' % o.amount_vat_20"/>
                    <span t-esc="o.currency_id.symbol"/>
                </td>
            </tr>
            <tr>
                <td><strong>Total TTC :</strong></td>
                <td class="text-end">
                    <strong t-esc="'%.0f' % o.amount_total_incl_vat_20"/>
                    <strong t-esc="o.currency_id.symbol"/>
                </td>
            </tr>
        </table>
    </xpath>

    <xpath expr="//div[@name='due_date']" position="replace"/>
    <xpath expr="//div[@name='origin']" position="replace"/>
    <xpath expr="//p[@name='payment_communication']" position="replace"/>

  </template>
</odoo>